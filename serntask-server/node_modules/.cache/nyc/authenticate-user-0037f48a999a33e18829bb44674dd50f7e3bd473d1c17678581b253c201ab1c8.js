function cov_2pnsbzfqzz(){var path="/Users/sergibittangonzalez/Desktop/SERNtask/serntask-server/logic/authenticate-user.js";var hash="3c4c7e095ebf8193fb7916d465e016c254fa098b";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/sergibittangonzalez/Desktop/SERNtask/serntask-server/logic/authenticate-user.js",statementMap:{"0":{start:{line:1,column:29},end:{line:1,column:53}},"1":{start:{line:2,column:15},end:{line:2,column:32}},"2":{start:{line:5,column:25},end:{line:25,column:1}},"3":{start:{line:8,column:4},end:{line:24,column:8}},"4":{start:{line:9,column:21},end:{line:9,column:50}},"5":{start:{line:11,column:8},end:{line:11,column:76}},"6":{start:{line:11,column:19},end:{line:11,column:76}},"7":{start:{line:13,column:30},end:{line:13,column:75}},"8":{start:{line:15,column:8},end:{line:15,column:64}},"9":{start:{line:15,column:28},end:{line:15,column:64}},"10":{start:{line:17,column:8},end:{line:17,column:39}},"11":{start:{line:19,column:8},end:{line:19,column:25}},"12":{start:{line:21,column:8},end:{line:21,column:22}},"13":{start:{line:26,column:0},end:{line:26,column:33}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:5,column:25},end:{line:5,column:26}},loc:{start:{line:5,column:46},end:{line:25,column:1}},line:5},"1":{name:"(anonymous_1)",decl:{start:{line:8,column:12},end:{line:8,column:13}},loc:{start:{line:8,column:24},end:{line:24,column:5}},line:8}},branchMap:{"0":{loc:{start:{line:11,column:8},end:{line:11,column:76}},type:"if",locations:[{start:{line:11,column:8},end:{line:11,column:76}},{start:{line:11,column:8},end:{line:11,column:76}}],line:11},"1":{loc:{start:{line:15,column:8},end:{line:15,column:64}},type:"if",locations:[{start:{line:15,column:8},end:{line:15,column:64}},{start:{line:15,column:8},end:{line:15,column:64}}],line:15}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"3c4c7e095ebf8193fb7916d465e016c254fa098b"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2pnsbzfqzz=function(){return actualCoverage;};}return actualCoverage;}cov_2pnsbzfqzz();const{models:{User}}=(cov_2pnsbzfqzz().s[0]++,require('serntask-data'));const bcrypt=(cov_2pnsbzfqzz().s[1]++,require('bcrypt'));cov_2pnsbzfqzz().s[2]++;const authenticateUser=(email,password)=>{cov_2pnsbzfqzz().f[0]++;cov_2pnsbzfqzz().s[3]++;// validate
return(async()=>{cov_2pnsbzfqzz().f[1]++;const user=(cov_2pnsbzfqzz().s[4]++,await User.findOne({email}));cov_2pnsbzfqzz().s[5]++;if(!user){cov_2pnsbzfqzz().b[0][0]++;cov_2pnsbzfqzz().s[6]++;throw new Error(`User with email: ${email} do not exist`);}else{cov_2pnsbzfqzz().b[0][1]++;}const validPassword=(cov_2pnsbzfqzz().s[7]++,await bcrypt.compare(password,user.password));cov_2pnsbzfqzz().s[8]++;if(!validPassword){cov_2pnsbzfqzz().b[1][0]++;cov_2pnsbzfqzz().s[9]++;throw new Error('wrong credentials');}else{cov_2pnsbzfqzz().b[1][1]++;}cov_2pnsbzfqzz().s[10]++;user.authenticated=new Date();cov_2pnsbzfqzz().s[11]++;await user.save();cov_2pnsbzfqzz().s[12]++;return user.id;})();};cov_2pnsbzfqzz().s[13]++;module.exports=authenticateUser;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhlbnRpY2F0ZS11c2VyLmpzIl0sIm5hbWVzIjpbIm1vZGVscyIsIlVzZXIiLCJyZXF1aXJlIiwiYmNyeXB0IiwiYXV0aGVudGljYXRlVXNlciIsImVtYWlsIiwicGFzc3dvcmQiLCJ1c2VyIiwiZmluZE9uZSIsIkVycm9yIiwidmFsaWRQYXNzd29yZCIsImNvbXBhcmUiLCJhdXRoZW50aWNhdGVkIiwiRGF0ZSIsInNhdmUiLCJpZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJpckVBZVk7MkZBZlosS0FBTSxDQUFFQSxNQUFNLENBQUUsQ0FBRUMsSUFBRixDQUFWLDJCQUF1QkMsT0FBTyxDQUFDLGVBQUQsQ0FBOUIsQ0FBTixDQUNBLEtBQU1DLENBQUFBLE1BQU0sMEJBQUdELE9BQU8sQ0FBQyxRQUFELENBQVYsQ0FBWixDLHdCQUdBLEtBQU1FLENBQUFBLGdCQUFnQixDQUFHLENBQUNDLEtBQUQsQ0FBUUMsUUFBUixHQUFxQixpREFDMUM7QUFFQSxNQUFPLENBQUMsU0FBWSx5QkFDaEIsS0FBTUMsQ0FBQUEsSUFBSSwwQkFBRyxLQUFNTixDQUFBQSxJQUFJLENBQUNPLE9BQUwsQ0FBYSxDQUFFSCxLQUFGLENBQWIsQ0FBVCxDQUFWLENBRGdCLHdCQUdoQixHQUFJLENBQUNFLElBQUwsQ0FBVyx5REFBTSxJQUFJRSxDQUFBQSxLQUFKLENBQVcsb0JBQW1CSixLQUFNLGVBQXBDLENBQU4sQ0FBeUQsQ0FBcEUsaUNBRUEsS0FBTUssQ0FBQUEsYUFBYSwwQkFBRyxLQUFNUCxDQUFBQSxNQUFNLENBQUNRLE9BQVAsQ0FBZUwsUUFBZixDQUF5QkMsSUFBSSxDQUFDRCxRQUE5QixDQUFULENBQW5CLENBTGdCLHdCQU9oQixHQUFJLENBQUNJLGFBQUwsQ0FBb0IseURBQU0sSUFBSUQsQ0FBQUEsS0FBSixDQUFVLG1CQUFWLENBQU4sQ0FBb0MsQ0FBeEQsaUNBUGdCLHlCQVNoQkYsSUFBSSxDQUFDSyxhQUFMLENBQXFCLEdBQUlDLENBQUFBLElBQUosRUFBckIsQ0FUZ0IseUJBV2hCLEtBQU1OLENBQUFBLElBQUksQ0FBQ08sSUFBTCxFQUFOLENBWGdCLHlCQWFoQixNQUFPUCxDQUFBQSxJQUFJLENBQUNRLEVBQVosQ0FHSCxDQWhCTSxHQUFQLENBaUJILENBcEJELEMseUJBcUJBQyxNQUFNLENBQUNDLE9BQVAsQ0FBaUJiLGdCQUFqQiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgbW9kZWxzOiB7IFVzZXIgfSB9ID0gcmVxdWlyZSgnc2VybnRhc2stZGF0YScpXG5jb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHQnKVxuXG5cbmNvbnN0IGF1dGhlbnRpY2F0ZVVzZXIgPSAoZW1haWwsIHBhc3N3b3JkKSA9PiB7XG4gICAgLy8gdmFsaWRhdGVcblxuICAgIHJldHVybiAoYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lKHsgZW1haWwgfSlcblxuICAgICAgICBpZiAoIXVzZXIpIHRocm93IG5ldyBFcnJvcihgVXNlciB3aXRoIGVtYWlsOiAke2VtYWlsfSBkbyBub3QgZXhpc3RgKVxuXG4gICAgICAgIGNvbnN0IHZhbGlkUGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgdXNlci5wYXNzd29yZClcblxuICAgICAgICBpZiAoIXZhbGlkUGFzc3dvcmQpIHRocm93IG5ldyBFcnJvcignd3JvbmcgY3JlZGVudGlhbHMnKVxuXG4gICAgICAgIHVzZXIuYXV0aGVudGljYXRlZCA9IG5ldyBEYXRlKClcblxuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKVxuXG4gICAgICAgIHJldHVybiB1c2VyLmlkXG5cblxuICAgIH0pKClcbn1cbm1vZHVsZS5leHBvcnRzID0gYXV0aGVudGljYXRlVXNlciJdfQ==